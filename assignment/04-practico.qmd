---
title: "Inferencia 1: Fundamentos"
date: "2023-09-05"
lang: es
website:
  comments:
    giscus:
      repo: cursos-metodos-facso/correlacional
---

# Objetivo de la práctica

El objetivo de esta guía práctica es aproximarnos a los fundamentos de la inferencia estadística, reforzando los contenidos respecto a sus conceptos centrales. Además, graficaremos la curva normal y calcularemos el puntaje z.

En detalle, aprenderemos:

1.  Los conceptos centrales de la inferencia estadística
2.  Qué es la curva normal y como graficarla
3.  Qué es y cómo calcular el puntaje $Z$

::: callout-note
**Acaso un *déjà vu*?**

¿Algo de esto nos suena conocido?

¿Recuerdan lo que vimos en [Estadística Descriptiva](https://descriptiva-facso.netlify.app/) respecto a inferencia?

En las sesiones 7 y 8 del laboratorio de análisis de datos pueden repasar.
:::

## Recursos de la práctica

En esta práctica trabajaremos con un subconjunto de datos previamente procesados del Estudio Longitudinal Social de Chile (ELSOC) del año 2016, elaborado por [COES](https://coes.cl/encuesta-panel/). Para este ejercicio, obtendremos directamente esta base desde internet. No obstante, también tienes la opción de acceder a la misma información a través del siguiente enlace: [{{< fa table >}} `ELSOC 2016`](https://multivariada.netlify.app/assignment/data/proc/ELSOC_ess_merit2016.RData). Desde allí, podrás descargar el archivo que contiene el subconjunto procesado de la base de datos ELSOC 2016.

# Conceptos centrales

Repasemos algunos de los conceptos fundamentales para la inferencia estadística vistos en la [sesión 5](https://correlacional.netlify.app/content/05-content), y algunos otros.

Prestemos atención a la siguiente imagen ¿dónde se inserta lo que vimos en estadística descriptiva? ¿Pueden definir todos los conceptos que se mencionan?

![](../files/INFERENCIA.jpg)

Vamos parte por parte.

**1. Población**: Corresponde al grupo entero de individuos sobre el que queremos información.

**2. Muestra**: Es un subconjunto de la población. Es la parte de la población que realmente examinamos con el objetivo de obtener información.

```{r, echo=FALSE, out.width='60%', fig.align='center'}
knitr::include_graphics("../files/pob_muestra.png")
```

**3. Parámetro**: es un número que describe la población. En la práctica estadística el valor del parámetro no es conocido ya que no podemos examinar toda la población.

**4. Estadístico**: es un número que se puede calcular a partir de los datos de la muestra sin utilizar ningún parámetro desconocido. En la práctica, solemos utilizar un estadístico para estimar el parámetro desconocido.

|                     | Población (parámetro) | Muestra (estadístico) |
|---------------------|-----------------------|-----------------------|
| Promedio            | $\mu$                 | $\bar{x}$             |
| Varianza            | $\sigma²$             | $s²$                  |
| Desviación estándar | $\sigma$              | $s$                   |
| Correlación         | $\rho$                | $r$                   |

**5. Inferencia**: La inferencia estadística proporciona métodos que permiten sacar conclusiones de una población a partir de los datos de una muestra.

**6. Error de muestreo**: diferencia entre el valor calculado de un estadístico de la muestra y el valor real de un parámetro de la población.


```{r, echo=FALSE, out.width='40%', fig.align='center'}
knitr::include_graphics("../files/poblacion.png")
knitr::include_graphics("../files/muestra1.png")
knitr::include_graphics("../files/muestra2.png")
```

**7. Variabilidad muestral**: el valor de un estadístico varía en un muestreo aleatorio repetido.

```{r, echo=FALSE, fig.align='center'}
knitr::include_graphics("../files/dist_muestral.png")
```

**8. Aleatoriedad**: Llamamos a un fenómeno aleatorio si los resultados individuales son inciertos y, sin embargo, existe una distribución regular de los resultados después de un gran número de repeticiones.

**9. Probabilidad**: es la proporción de veces que el resultado se da después de una larga serie de repeticiones.

**10. Distribución**: se refiere al conjunto de todos los valores posibles de una variable y las frecuencias (o probabilidades) con las que se producen.

<!-- **11. Distribución muestral**: La distribución muestral de un estadístico es la distribución de los valores tomados por él en todas las muestras posibles de igual tamaño de la misma población. -->


# Curva normal

La curva normal es un tipo de **distribución** en la que la frecuencia con la que ocurren los valores de la variable se asemeja a una campana. Esto quiere decir que se presenta una menor frecuencia de observaciones para los valores mayores y menores de la variable, y una mayor frecuencia de observaciones para aquellos valores que se encuentran hacia el centro de la distribución.

![](../files/norm1.png)

::: callout-note
¿Cuáles variables te imaginas que se pueden distribuir de manera normal?
:::

Esto tiene algunas implicancias cuando nos acompañamos de la probabilidad. 

![](../files/reg_prob.png)

En una distribución normal de media $\mu$ y desviación estándar $\sigma$:

- El **68%** de todas las observaciones se encuentran dentro del
intervalo µ ± σ.

- El **95%** de todas las observaciones se encuentran dentro del
intervalo µ ± 2σ.

- El **99,7%** de todas las observaciones se encuentran dentro del in-
tervalo µ ± 3σ.

![](../files/norm2.png)

¡Veamos un ejemplo!

## Preparación datos

Comencemos por preparar nuestros datos. Iniciamos cargando las librerías necesarias.

```{r librerias, echo=TRUE, message=FALSE, warning=FALSE, collapse=TRUE}
pacman::p_load(tidyverse,  # Manipulacion datos
               sjmisc,     # Descriptivos
               sjPlot,     # Tablas
               kableExtra, # Tablas
               ggplot2)    # Graficos

options(scipen = 999) # para desactivar notacion cientifica
rm(list = ls()) # para limpiar el entorno de trabajo
```

Cargamos los datos directamente desde internet (por esta vez).

```{r datos, echo=TRUE, message=FALSE, warning=FALSE}

load(url("https://multivariada.netlify.app/assignment/data/proc/ELSOC_ess_merit2016.RData")) #Cargar base de datos

```

A continuación, exploramos la base de datos **proc_elsoc**.

```{r exploracion, echo=TRUE, message=FALSE, warning=FALSE}

names(proc_elsoc) # Nombre de columnas
dim(proc_elsoc) # Dimensiones
str(proc_elsoc) # Estructura de los datos
```

Contamos con 7 variables (columnas) y 2927 observaciones (filas).

En esta ocasión, trabajaremos con la variable 'edad', para ello, observemos algunos estadísticos descriptivos de resumen de nuestra para esta variable. Utilizaremos la función `descr` del paquete `sjmisc`.

```{r descripcion, echo=TRUE, message=FALSE, warning=FALSE}
sjmisc::descr(proc_elsoc$edad,
      show = c("label","range", "mean", "sd", "NA.prc", "n")) %>%
      kable(.,"markdown")
```

## Histograma de frecuencias

Primero, realizaremos un histograma de frecuencias o de probabilidad de la variable edad, esto es, la frecuencia con la que se presenta cada uno de los valores posibles de la variable.

```{r}
ggplot(proc_elsoc, aes(edad)) + 
  geom_histogram(aes(x = edad, y = after_stat(density)), bins = 50, color = "black", fill = "grey") 
```

A esto también lo llamamos **distribución empírica**, y quiere decir que es la distribución que toman los datos reales de nuestra muestra.

## Curvas de densidad

Las curvas de densidad son un modelo matemático de la distribución. Lo importante de graficarlo es que nos permite estimar una probabilidad, ya que el área por debajo de la curva, y entre cualquier intervalo de valores, es la proporción de todas las observaciones que están situadas en dicho intervalo.

¡Veamos cómo se ve!

```{r warning=FALSE}
ggplot(proc_elsoc, aes(edad)) + 
  geom_histogram(aes(x = edad, y = ..density..), bins = 50, color = "black", fill = "grey") +
  geom_density(color = "blue")
```

## Curva de distribución normal

Ahora, pondremos por encima la curva normal, que funciona como **distribución teórica** de los datos y nos permite realizar inferencia estadística. 

```{r}
ggplot(proc_elsoc, aes(edad)) + 
  geom_histogram(aes(x = edad, y = ..density..), bins = 50, color = "black", fill = "grey") +
  geom_density(color = "blue")+
  stat_function(fun = dnorm, args = list(mean = mean(proc_elsoc$edad), sd = sd(proc_elsoc$edad)))
```

# Puntaje z y estandarización

Los valores $z$, o puntuación estandarizada, permiten calcular la proporción de casos bajo la curva normal que están sobre y bajo el puntaje, al mismo tiempo que estandarizar valores.

Un valor z nos dice a cuántas desviaciones típicas se encuentra la observación original de la media y en qué dirección.

$$z=\frac{x-\mu}{\sigma}$$
## Cálculo de puntaje z

Calculemos el puntaje $z$ para la edad de cuarenta años, donde:

- $x$: valor de edad para el que realizaremos el cálculo, en este caso 40 años
- $\mu$: media de la edad
- $\sigma$ : desviación estándar de la edad

```{r}
z <- (40-mean(proc_elsoc$edad))/sd(proc_elsoc$edad)
z
```
Ahora le pedimos que nos entregue el área bajo la curva: 

```{r}
pnorm(-0.398)
```
Esto quiere decir que el 34.5% de las observaciones es menor a 40 años, y que, por consiguiente, el 65.5% se encuentra sobre esa edad. 

Pero, qué pasa si quiero hacer la pregunta al revés: ¿Menor a qué edad es el 10% más joven?

```{r}
qnorm(p=0.1, mean = mean(proc_elsoc$edad), sd=sd(proc_elsoc$edad))
```
Esto quiere decir que el 10% más joven es menor a 26.5 años.

# Practiquemos

Ahora, realizaremos un breve ejercicio utilizando nuestra base de datos.

- Identificaremos los na's
- Eliminaremos todos los na's
- Graficaremos un histograma para Estado social subjetivo (ess), con su curva de densidad, más la curva normal.
- Calcularemos el porcentaje se encuentra por sobre el valor 6
- ¿Por sobre cuál valor se ubica el 30% más alto?
- ¿Por bajo cuál valor se ubica el 30% más bajo?


# Resumen

Hoy pudimos recordar y repasar los conceptos fundamentales de la inferencia estadística. Además, pudimos reforzar la idea de distribucón, donde específicamente repasamos el contenido referente a la curva de distribución normal y pudimos graficarla. Además, calculamos el puntaje z y aprendimos acerca de estandarización.

En detalle, aprenderemos:

1.  Los conceptos centrales de la inferencia estadística
2.  Qué es la curva normal y como graficarla
3.  Qué es y cómo calcular el puntaje $Z$

# Reporte de progreso

Completar el reporte de progreso correspondiente a esta práctica [aquí](https://docs.google.com/forms/d/e/1FAIpQLSfj2Ubj-kHUePt4G0lOBm_wJO-op4s-WKoSiyaBs_bnrBJDiQ/viewform?usp=sf_link). El plazo para contestarlo es hasta el día viernes de la semana en la que se publica la práctica correspondiente.

# Video de práctica

# Foro

```{=html}
<script src="https://giscus.app/client.js"
        data-repo="cursos-metodos-facso/correlacional"
        data-repo-id="R_kgDOKCMXJQ"
        data-category="Q&A"
        data-category-id="DIC_kwDOKCMXJc4CYd9S"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="es"
        crossorigin="anonymous"
        async>
</script>
```
